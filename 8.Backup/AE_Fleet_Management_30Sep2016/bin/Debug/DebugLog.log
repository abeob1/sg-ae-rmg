[09/28/2016 18:38:41][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '8','9')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '8','9') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20160801' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '1' and DAY(T0.[U_AE_NXDT]) <= '1' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '8' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[09/28/2016 18:41:55][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '8','9')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '8','9') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20160806' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '6' and DAY(T0.[U_AE_NXDT]) <= '6' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '8' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[09/28/2016 19:14:33][SD Recurring Invoice Generation Function()] Starting Function
[09/28/2016 19:14:33][SD Recurring Invoice Generation Function()] Starting Function
[09/28/2016 19:14:33][SD_InvoiceGeneration() - For RA 20092] Starting Function
[09/28/2016 19:14:33][                         20092] Fetching the information for RA 
[09/28/2016 19:14:33][                              ] Posting Date 2016-08-06
[09/28/2016 19:14:33][                              ] ADate 2014-06-06
[09/28/2016 19:14:33][                           Yes] CDW Flag status 
[09/28/2016 19:14:33][                           Yes] PAI Flag status 
[09/28/2016 19:14:33][                         20092] Generating the Invoice for RA 
[09/28/2016 19:14:34][                         20092] Completed with  SUCCESS 
[09/28/2016 19:14:34][                          2240] Generated Invoice Number is 
[09/28/2016 19:14:34][          UDO_Update_SelfDrive] Starting Function
[09/28/2016 19:14:34][                   AE_Sbooking] Attempting UDO Object 
[09/28/2016 19:14:34][                            92] Set the RA Document Entry for update 
[09/28/2016 19:14:34][                    06/08/2016] NInvDateNew 
[09/28/2016 19:14:34][                    06/09/2016] NInvDateNew.AddMonths(1) 
[09/28/2016 19:14:34][                    06/09/2016] Set the Next service date 
[09/28/2016 19:14:34][                       570 , 1] Property check for idenftify the Line Num  
[09/28/2016 19:14:34][                   AE_Sbooking] Start updating the UDO 
[09/28/2016 19:14:34][        UDO_Update_SelfDrive()] Completed with SUCCESS 
[09/28/2016 19:14:34][        SD_InvoiceGeneration()] Completed with SUCCESS 
[09/28/2016 19:14:34][SD_InvoiceGeneration() - For RA 20092] Completed With SUCCESS
[09/28/2016 19:14:34][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '8','9')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '8','9') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20160806' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '6' and DAY(T0.[U_AE_NXDT]) <= '6' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '8' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[09/28/2016 19:14:35][SD_InvoiceGeneration() - For RA 20092] Completed with SUCCESS
[09/28/2016 19:14:39][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '9','10')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '9','10') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20160806' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '6' and DAY(T0.[U_AE_NXDT]) <= '6' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '9' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/24/2016 15:34:40][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161001' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '1' and DAY(T0.[U_AE_NXDT]) <= '1' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/24/2016 16:06:22][SD Recurring Invoice Generation Function()] Starting Function
[10/24/2016 16:06:22][SD Recurring Invoice Generation Function()] Starting Function
[10/24/2016 16:06:22][SD_InvoiceGeneration() - For RA 20034] Starting Function
[10/24/2016 16:06:22][                         20034] Fetching the information for RA 
[10/24/2016 16:06:22][                              ] Posting Date 2016-10-01
[10/24/2016 16:06:22][                              ] ADate 2016-09-01
[10/24/2016 16:06:33][                           Yes] CDW Flag status 
[10/24/2016 16:06:35][                            No] PAI Flag status 
[10/24/2016 16:06:39][                         20034] Generating the Invoice for RA 
[10/24/2016 16:06:45][                         20034] Completed with  SUCCESS 
[10/24/2016 16:06:46][                          2241] Generated Invoice Number is 
[10/24/2016 16:06:48][          UDO_Update_SelfDrive] Starting Function
[10/24/2016 16:06:48][                   AE_Sbooking] Attempting UDO Object 
[10/24/2016 16:06:48][                            34] Set the RA Document Entry for update 
[10/24/2016 16:06:48][                    01/10/2016] NInvDateNew 
[10/24/2016 16:06:48][                    01/11/2016] NInvDateNew.AddMonths(1) 
[10/24/2016 16:06:48][                    01/11/2016] Set the Next service date 
[10/24/2016 16:06:48][                      1576 , 4] Property check for idenftify the Line Num  
[10/24/2016 16:06:48][                   AE_Sbooking] Start updating the UDO 
[10/24/2016 16:06:48][        UDO_Update_SelfDrive()] Completed with SUCCESS 
[10/24/2016 16:06:55][        SD_InvoiceGeneration()] Completed with SUCCESS 
[10/24/2016 16:06:55][SD_InvoiceGeneration() - For RA 20034] Completed With SUCCESS
[10/24/2016 16:06:55][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161001' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '1' and DAY(T0.[U_AE_NXDT]) <= '1' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/24/2016 16:06:55][SD_InvoiceGeneration() - For RA 20034] Completed with SUCCESS
[10/24/2016 16:07:01][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '11','12')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '11','12') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161001' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '1' and DAY(T0.[U_AE_NXDT]) <= '1' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '11' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/24/2016 16:15:26][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161001' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '16' and DAY(T0.[U_AE_NXDT]) <= '31' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/24/2016 16:15:47][SD Recurring Invoice Generation Function()] Starting Function
[10/24/2016 16:15:47][SD Recurring Invoice Generation Function()] Starting Function
[10/24/2016 16:15:48][SD_InvoiceGeneration() - For RA 20005] Starting Function
[10/24/2016 16:15:48][                         20005] Fetching the information for RA 
[10/24/2016 16:15:48][                              ] Posting Date 2016-10-01
[10/24/2016 16:15:48][                              ] ADate 2014-06-27
[10/24/2016 16:16:06][                           Yes] CDW Flag status 
[10/24/2016 16:16:06][                            No] PAI Flag status 
[10/24/2016 16:16:06][                         20005] Generating the Invoice for RA 
[10/24/2016 16:16:06][                         20005] Completed with  SUCCESS 
[10/24/2016 16:16:06][                          2242] Generated Invoice Number is 
[10/24/2016 16:16:06][          UDO_Update_SelfDrive] Starting Function
[10/24/2016 16:16:06][                   AE_Sbooking] Attempting UDO Object 
[10/24/2016 16:16:06][                             5] Set the RA Document Entry for update 
[10/24/2016 16:16:06][                    27/10/2016] NInvDateNew 
[10/24/2016 16:16:06][                    27/11/2016] NInvDateNew.AddMonths(1) 
[10/24/2016 16:16:06][                    27/11/2016] Set the Next service date 
[10/24/2016 16:16:06][                       401 , 1] Property check for idenftify the Line Num  
[10/24/2016 16:16:06][                   AE_Sbooking] Start updating the UDO 
[10/24/2016 16:16:06][        UDO_Update_SelfDrive()] Completed with SUCCESS 
[10/24/2016 16:16:06][        SD_InvoiceGeneration()] Completed with SUCCESS 
[10/24/2016 16:16:06][SD_InvoiceGeneration() - For RA 20005] Completed With SUCCESS
[10/24/2016 16:16:07][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161001' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '16' and DAY(T0.[U_AE_NXDT]) <= '31' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/24/2016 16:16:07][SD_InvoiceGeneration() - For RA 20005] Completed with SUCCESS
[10/24/2016 16:16:15][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '11','12')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '11','12') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161001' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '16' and DAY(T0.[U_AE_NXDT]) <= '31' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '11' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
