[10/26/2016 02:35:37][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161001' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '1' and DAY(T0.[U_AE_NXDT]) <= '1' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 14:37:00][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161015' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '16' and DAY(T0.[U_AE_NXDT]) <= '31' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and year(tt.DocDate) = '2016' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 14:37:15][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161015' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '27' and DAY(T0.[U_AE_NXDT]) <= '27' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and year(tt.DocDate) = '2016' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 14:37:40][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 14:37:40][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 14:37:40][SD_InvoiceGeneration() - For RA 20210] Starting Function
[10/31/2016 14:37:41][                         20210] Fetching the information for RA 
[10/31/2016 14:37:41][                              ] Posting Date 2016-10-15
[10/31/2016 14:37:41][                              ] ADate 2016-10-27
[10/31/2016 14:37:41][                           Yes] CDW Flag status 
[10/31/2016 14:37:41][                            No] PAI Flag status 
[10/31/2016 14:37:41][                         20210] Generating the Invoice for RA 
[10/31/2016 14:37:41][                         20210] Completed with  SUCCESS 
[10/31/2016 14:37:41][                          2243] Generated Invoice Number is 
[10/31/2016 14:37:41][          UDO_Update_SelfDrive] Starting Function
[10/31/2016 14:37:41][                   AE_Sbooking] Attempting UDO Object 
[10/31/2016 14:37:41][                           210] Set the RA Document Entry for update 
[10/31/2016 14:37:41][                    27/10/2016] NInvDateNew 
[10/31/2016 14:37:41][                    27/11/2016] NInvDateNew.AddMonths(1) 
[10/31/2016 14:37:41][                    27/11/2016] Set the Next service date 
[10/31/2016 14:37:41][                      2471 , 2] Property check for idenftify the Line Num  
[10/31/2016 14:37:41][                   AE_Sbooking] Start updating the UDO 
[10/31/2016 14:37:41][        UDO_Update_SelfDrive()] Completed with SUCCESS 
[10/31/2016 14:37:41][        SD_InvoiceGeneration()] Completed with SUCCESS 
[10/31/2016 14:37:41][SD_InvoiceGeneration() - For RA 20210] Completed With SUCCESS
[10/31/2016 14:37:41][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161015' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '27' and DAY(T0.[U_AE_NXDT]) <= '27' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and year(tt.DocDate) = '2016' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 14:37:41][SD_InvoiceGeneration() - For RA 20210] Completed with SUCCESS
[10/31/2016 14:37:46][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '11','12')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '11','12') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161015' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '27' and DAY(T0.[U_AE_NXDT]) <= '27' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '11' and year(tt.DocDate) = '2016' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 14:38:04][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161015' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '27' and DAY(T0.[U_AE_NXDT]) <= '27' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and year(tt.DocDate) = '2016' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 14:38:08][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 14:38:08][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 14:38:08][SD_InvoiceGeneration() - For RA 20805] Starting Function
[10/31/2016 14:38:08][                         20805] Fetching the information for RA 
[10/31/2016 14:38:08][                              ] Posting Date 2016-10-15
[10/31/2016 14:38:08][                              ] ADate 2016-10-27
[10/31/2016 14:38:08][                            No] CDW Flag status 
[10/31/2016 14:38:08][                            No] PAI Flag status 
[10/31/2016 14:38:08][                         20805] Generating the Invoice for RA 
[10/31/2016 14:38:08][                         20805] Completed with  SUCCESS 
[10/31/2016 14:38:08][                          2244] Generated Invoice Number is 
[10/31/2016 14:38:08][          UDO_Update_SelfDrive] Starting Function
[10/31/2016 14:38:08][                   AE_Sbooking] Attempting UDO Object 
[10/31/2016 14:38:08][                           805] Set the RA Document Entry for update 
[10/31/2016 14:38:08][                    27/10/2016] NInvDateNew 
[10/31/2016 14:38:08][                    27/11/2016] NInvDateNew.AddMonths(1) 
[10/31/2016 14:38:08][                    27/11/2016] Set the Next service date 
[10/31/2016 14:38:08][                      3390 , 1] Property check for idenftify the Line Num  
[10/31/2016 14:38:08][                   AE_Sbooking] Start updating the UDO 
[10/31/2016 14:38:08][        UDO_Update_SelfDrive()] Completed with SUCCESS 
[10/31/2016 14:38:08][        SD_InvoiceGeneration()] Completed with SUCCESS 
[10/31/2016 14:38:08][SD_InvoiceGeneration() - For RA 20805] Completed With SUCCESS
[10/31/2016 14:38:08][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161015' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '27' and DAY(T0.[U_AE_NXDT]) <= '27' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and year(tt.DocDate) = '2016' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 14:38:08][SD_InvoiceGeneration() - For RA 20805] Completed with SUCCESS
[10/31/2016 14:38:26][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '11','12')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '11','12') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161015' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '27' and DAY(T0.[U_AE_NXDT]) <= '27' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '11' and year(tt.DocDate) = '2016' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 15:13:04][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161015' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '16' and DAY(T0.[U_AE_NXDT]) <= '31' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and year(tt.DocDate) = '2016' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 15:13:12][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161015' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '27' and DAY(T0.[U_AE_NXDT]) <= '27' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and year(tt.DocDate) = '2016' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 15:13:41][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:13:41][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:13:41][SD_InvoiceGeneration() - For RA 20805] Starting Function
[10/31/2016 15:13:41][                         20805] Fetching the information for RA 
[10/31/2016 15:13:41][                              ] Posting Date 15.10.16
[10/31/2016 15:13:41][                              ] ADate 27.10.16
[10/31/2016 15:13:41][                            No] CDW Flag status 
[10/31/2016 15:13:41][                            No] PAI Flag status 
[10/31/2016 15:13:41][                         20805] Generating the Invoice for RA 
[10/31/2016 15:13:42][                         20805] Completed with ERROR  Inactive employee; specify an active employee  [OINV.OwnerCode] for RA 
[10/31/2016 15:14:34][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:14:34][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:14:45][SD_InvoiceGeneration() - For RA 20805] Starting Function
[10/31/2016 15:15:08][                         20805] Fetching the information for RA 
[10/31/2016 15:15:29][                              ] Posting Date 15.10.16
[10/31/2016 15:15:30][                              ] ADate 27.10.16
[10/31/2016 15:15:45][                            No] CDW Flag status 
[10/31/2016 15:15:47][                            No] PAI Flag status 
[10/31/2016 15:15:57][                         20805] Generating the Invoice for RA 
[10/31/2016 15:16:06][                         20805] Completed with ERROR  Inactive employee; specify an active employee  [OINV.OwnerCode] for RA 
[10/31/2016 15:20:32][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:20:32][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:20:58][SD_InvoiceGeneration() - For RA 20805] Starting Function
[10/31/2016 15:20:58][                         20805] Fetching the information for RA 
[10/31/2016 15:20:58][                              ] Posting Date 15.10.16
[10/31/2016 15:20:58][                              ] ADate 27.10.16
[10/31/2016 15:20:58][                            No] CDW Flag status 
[10/31/2016 15:20:58][                            No] PAI Flag status 
[10/31/2016 15:20:58][                         20805] Generating the Invoice for RA 
[10/31/2016 15:21:14][                         20805] Completed with ERROR  Inactive employee; specify an active employee  [OINV.OwnerCode] for RA 
[10/31/2016 15:23:26][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:23:26][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:23:30][SD_InvoiceGeneration() - For RA 20210] Starting Function
[10/31/2016 15:23:30][                         20210] Fetching the information for RA 
[10/31/2016 15:23:30][                              ] Posting Date 15.10.16
[10/31/2016 15:23:30][                              ] ADate 27.10.16
[10/31/2016 15:23:30][                           Yes] CDW Flag status 
[10/31/2016 15:23:30][                            No] PAI Flag status 
[10/31/2016 15:23:30][                         20210] Generating the Invoice for RA 
[10/31/2016 15:23:30][                         20210] Completed with  SUCCESS 
[10/31/2016 15:23:30][                       1511344] Generated Invoice Number is 
[10/31/2016 15:23:30][          UDO_Update_SelfDrive] Starting Function
[10/31/2016 15:23:30][                   AE_Sbooking] Attempting UDO Object 
[10/31/2016 15:23:31][                           210] Set the RA Document Entry for update 
[10/31/2016 15:23:31][                    27/10/2016] NInvDateNew 
[10/31/2016 15:23:31][                    27/11/2016] NInvDateNew.AddMonths(1) 
[10/31/2016 15:23:31][                    27/11/2016] Set the Next service date 
[10/31/2016 15:23:31][                      2471 , 2] Property check for idenftify the Line Num  
[10/31/2016 15:23:31][                   AE_Sbooking] Start updating the UDO 
[10/31/2016 15:23:31][        UDO_Update_SelfDrive()] Completed with SUCCESS 
[10/31/2016 15:23:31][        SD_InvoiceGeneration()] Completed with SUCCESS 
[10/31/2016 15:23:31][SD_InvoiceGeneration() - For RA 20210] Completed With SUCCESS
[10/31/2016 15:23:31][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161015' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '27' and DAY(T0.[U_AE_NXDT]) <= '27' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and year(tt.DocDate) = '2016' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 15:23:31][SD_InvoiceGeneration() - For RA 20210] Completed with SUCCESS
[10/31/2016 15:33:13][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:33:13][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:33:13][SD_InvoiceGeneration() - For RA 20805] Starting Function
[10/31/2016 15:33:13][                         20805] Fetching the information for RA 
[10/31/2016 15:33:13][                              ] Posting Date 15.10.16
[10/31/2016 15:33:13][                              ] ADate 27.10.16
[10/31/2016 15:33:13][                            No] CDW Flag status 
[10/31/2016 15:33:13][                            No] PAI Flag status 
[10/31/2016 15:33:13][                         20805] Generating the Invoice for RA 
[10/31/2016 15:33:13][                         20805] Completed with ERROR  Inactive employee; specify an active employee  [OINV.OwnerCode] for RA 
[10/31/2016 15:33:48][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:33:48][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:33:48][SD_InvoiceGeneration() - For RA 20005] Starting Function
[10/31/2016 15:33:48][                         20005] Fetching the information for RA 
[10/31/2016 15:33:48][                              ] Posting Date 15.10.16
[10/31/2016 15:33:48][                              ] ADate 27.10.16
[10/31/2016 15:33:48][                           Yes] CDW Flag status 
[10/31/2016 15:33:48][                            No] PAI Flag status 
[10/31/2016 15:33:48][                         20005] Generating the Invoice for RA 
[10/31/2016 15:33:48][                         20005] Completed with  SUCCESS 
[10/31/2016 15:33:48][                       1511346] Generated Invoice Number is 
[10/31/2016 15:33:48][          UDO_Update_SelfDrive] Starting Function
[10/31/2016 15:33:48][                   AE_Sbooking] Attempting UDO Object 
[10/31/2016 15:33:48][                             5] Set the RA Document Entry for update 
[10/31/2016 15:33:48][                    27/10/2016] NInvDateNew 
[10/31/2016 15:33:48][                    27/11/2016] NInvDateNew.AddMonths(1) 
[10/31/2016 15:33:48][                    27/11/2016] Set the Next service date 
[10/31/2016 15:33:48][                      2250 , 2] Property check for idenftify the Line Num  
[10/31/2016 15:33:48][                   AE_Sbooking] Start updating the UDO 
[10/31/2016 15:33:48][        UDO_Update_SelfDrive()] Completed with SUCCESS 
[10/31/2016 15:33:48][        SD_InvoiceGeneration()] Completed with SUCCESS 
[10/31/2016 15:33:48][SD_InvoiceGeneration() - For RA 20005] Completed With SUCCESS
[10/31/2016 15:33:48][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161015' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '27' and DAY(T0.[U_AE_NXDT]) <= '27' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and year(tt.DocDate) = '2016' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 15:33:48][SD_InvoiceGeneration() - For RA 20005] Completed with SUCCESS
[10/31/2016 15:34:21][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:34:21][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:34:21][SD_InvoiceGeneration() - For RA 20805] Starting Function
[10/31/2016 15:34:21][                         20805] Fetching the information for RA 
[10/31/2016 15:34:21][                              ] Posting Date 15.10.16
[10/31/2016 15:34:21][                              ] ADate 27.10.16
[10/31/2016 15:34:21][                            No] CDW Flag status 
[10/31/2016 15:34:21][                            No] PAI Flag status 
[10/31/2016 15:34:21][                         20805] Generating the Invoice for RA 
[10/31/2016 15:34:21][                         20805] Completed with ERROR  Inactive employee; specify an active employee  [OINV.OwnerCode] for RA 
[10/31/2016 15:36:48][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:36:48][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:36:48][SD_InvoiceGeneration() - For RA 20805] Starting Function
[10/31/2016 15:36:48][                         20805] Fetching the information for RA 
[10/31/2016 15:36:48][                              ] Posting Date 15.10.16
[10/31/2016 15:36:48][                              ] ADate 27.10.16
[10/31/2016 15:36:48][                            No] CDW Flag status 
[10/31/2016 15:36:48][                            No] PAI Flag status 
[10/31/2016 15:36:48][                         20805] Generating the Invoice for RA 
[10/31/2016 15:36:48][                         20805] Completed with ERROR  Inactive employee; specify an active employee  [OINV.OwnerCode] for RA 
[10/31/2016 15:38:47][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:38:47][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:38:47][SD_InvoiceGeneration() - For RA 20805] Starting Function
[10/31/2016 15:38:47][                         20805] Fetching the information for RA 
[10/31/2016 15:38:47][                              ] Posting Date 15.10.16
[10/31/2016 15:38:47][                              ] ADate 27.10.16
[10/31/2016 15:38:47][                            No] CDW Flag status 
[10/31/2016 15:38:47][                            No] PAI Flag status 
[10/31/2016 15:38:47][                         20805] Generating the Invoice for RA 
[10/31/2016 15:38:47][                         20805] Completed with ERROR  Inactive employee; specify an active employee  [OINV.OwnerCode] for RA 
[10/31/2016 15:56:12][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:56:12][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:56:12][SD_InvoiceGeneration() - For RA 20805] Starting Function
[10/31/2016 15:56:13][                         20805] Fetching the information for RA 
[10/31/2016 15:56:13][                              ] Posting Date 15.10.16
[10/31/2016 15:56:13][                              ] ADate 27.10.16
[10/31/2016 15:56:13][                            No] CDW Flag status 
[10/31/2016 15:56:13][                            No] PAI Flag status 
[10/31/2016 15:56:13][                         20805] Generating the Invoice for RA 
[10/31/2016 15:56:13][                         20805] Completed with ERROR  Inactive employee; specify an active employee  [OINV.OwnerCode] for RA 
[10/31/2016 15:56:44][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:56:44][SD Recurring Invoice Generation Function()] Starting Function
[10/31/2016 15:56:44][SD_InvoiceGeneration() - For RA 20805] Starting Function
[10/31/2016 15:56:45][                         20805] Fetching the information for RA 
[10/31/2016 15:56:45][                              ] Posting Date 15.10.16
[10/31/2016 15:56:45][                              ] ADate 27.10.16
[10/31/2016 15:56:45][                            No] CDW Flag status 
[10/31/2016 15:56:45][                            No] PAI Flag status 
[10/31/2016 15:56:45][                         20805] Generating the Invoice for RA 
[10/31/2016 15:56:45][                         20805] Completed with  SUCCESS 
[10/31/2016 15:56:45][                       1511347] Generated Invoice Number is 
[10/31/2016 15:56:45][          UDO_Update_SelfDrive] Starting Function
[10/31/2016 15:56:45][                   AE_Sbooking] Attempting UDO Object 
[10/31/2016 15:56:45][                           805] Set the RA Document Entry for update 
[10/31/2016 15:56:45][                    27/10/2016] NInvDateNew 
[10/31/2016 15:56:45][                    27/11/2016] NInvDateNew.AddMonths(1) 
[10/31/2016 15:56:45][                    27/11/2016] Set the Next service date 
[10/31/2016 15:56:45][                      3390 , 1] Property check for idenftify the Line Num  
[10/31/2016 15:56:45][                   AE_Sbooking] Start updating the UDO 
[10/31/2016 15:56:45][        UDO_Update_SelfDrive()] Completed with SUCCESS 
[10/31/2016 15:56:45][        SD_InvoiceGeneration()] Completed with SUCCESS 
[10/31/2016 15:56:45][SD_InvoiceGeneration() - For RA 20805] Completed With SUCCESS
[10/31/2016 15:56:45][          Recurring Billing ()] Recurring Billing SELECT T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], case when month(T0.[U_AE_Vdatein]) in ( '10','11')  then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then (T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1)  else T0.[U_AE_rate] end ) else T0.[U_AE_rate] end  as 'U_AE_rate', case when month(T0.[U_AE_Vdatein]) in ( '10','11') then ( case when T0.U_AE_Sdate = T0.[U_AE_NXDT] then ('Long Term Return Calculation ' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental          : ' + cast(cast(T0.[U_AE_Rate] as decimal(19,4)) as nvarchar ) + char(13) + 'Days in Billing Cycle   : ' +  cast(DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) as nvarchar) + char(13) +  'Consumed Days         : ' + cast((DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as nvarchar) + char(13) + 'Calculated Amount     : ' + cast(cast((T0.[U_AE_Rate]/DATEDIFF(day,U_AE_NXDT,DATEADD(m,1,U_AE_NXDT) ) )*(DATEDIFF(day,U_AE_Sdate,U_AE_Vdatein)+1) as decimal(19,4)) as varchar)) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end ) else 'Long Term Recurring Calculation' + CHAR(13) + '----------------------------------------' + CHAR(13) + CHAR(13) + 'Monthly Rental         : ' + cast(cast(T0.[U_AE_rate] as decimal(19,4)) as nvarchar) end  as 'Cal',  T0.[U_AE_NXDT], T0.[Docentry] , cast('20161015' as datetime)  'U_AE_Sdate' FROM [dbo].[@AE_SBOOKING]  T0  , OINV T1 WHERE  DAY(T0.[U_AE_NXDT]) >= '27' and DAY(T0.[U_AE_NXDT]) <= '27' and T0.[U_AE_Status] = 'Open' and T0.DocNum not in (select rtrim(substring(TT.NumAtCard , 3 , len(Tt.NumAtCard) -2)) from OINV tt where month(tt.DocDate) = '10' and year(tt.DocDate) = '2016' and left(TT.NumAtCard,2) = 'SD' and isnull(TT.U_AE_BCC,'N') = 'N'  ) group by T0.[DocNum], T0.[U_AE_Bname], T0.[U_AE_Bcode], T0.[U_AE_Vregno], T0.[U_AE_Rno], T0.[U_AE_Contract], T0.[U_AE_NXDT], T0.[U_AE_Vdatein],T0.[U_AE_Rate], T0.[DocEntry],T0.[U_AE_Sdate] 
[10/31/2016 15:56:45][SD_InvoiceGeneration() - For RA 20805] Completed with SUCCESS
